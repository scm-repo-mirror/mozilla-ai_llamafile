diff --git a/common/chat.cpp b/common/chat.cpp
--- a/llama.cpp/common/chat.cpp
+++ b/llama.cpp/common/chat.cpp
@@ -1437,7 +1437,7 @@ static common_chat_params common_chat_params_init_deepseek_v3_1(const common_cha
     };
 
     auto prompt = apply(tmpl, inputs,
-                       /* messages_override= */ inputs.messages,
+                       /* messages_override= */ std::optional<json>(inputs.messages),
                        /* tools_override= */ std::nullopt,
                        additional_context);
     data.prompt = prompt;
